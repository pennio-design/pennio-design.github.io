<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PENNIO | Brand Architecture for Vision-Driven Founders</title>
  
  <!-- Premium Typography -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Syne:wght@400;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600&display=swap" rel="stylesheet">
  
  <!-- Tailwind Utilities (Retained for possible React component use) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#fff7ed',
              100: '#ffedd5',
              500: '#D4722A',
              600: '#E8844A',
              900: '#080808',
            }
          }
        }
      }
    }
  </script>

  <!-- ESM Imports for React Environment -->
  <script type="importmap">
  {
    "imports": {
      "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
      "lucide-react": "https://esm.sh/lucide-react@^0.563.0",
      "react/": "https://esm.sh/react@^19.2.3/",
      "react": "https://esm.sh/react@^19.2.3",
      "@google/genai": "https://esm.sh/@google/genai@^1.38.0"
    }
  }
  </script>
  
  <!-- Global Styles (Now points to your updated index.css file) -->
  <link rel="stylesheet" href="/index.css">
</head>
<body>

  <!-- React Mount Point (Hidden by default, used if you write React components later) -->
  <div id="root"></div>

  <!-- Scroll progress -->
  <div class="scroll-line" id="scrollLine"></div>

  <!-- ─── NAV ─────────────────────────────────────────────────────────── -->
  <nav>
    <div class="nav-inner">
      <div class="nav-logo" onclick="switchView('landing')">PENNIO<span>.</span>DESIGN</div>
      <div class="nav-links">
        <button class="nav-link" onclick="switchView('landing'); scrollToEl('framework')">Framework</button>
        <button class="nav-link" onclick="switchView('strategy')">Brand Sim</button>
        <a href="https://pennio-design.github.io/portfolio.pdf" target="_blank" class="nav-link">Portfolio</a>
        <a href="#apply" onclick="switchView('landing')" class="nav-cta">Free Diagnosis</a>
      </div>
      <button class="hamburger" id="hamburger" aria-label="Toggle menu" onclick="toggleMenu()">
        <span></span><span></span><span></span>
      </button>
    </div>
  </nav>

  <div class="mobile-menu" id="mobileMenu">
    <button class="mobile-menu-link" onclick="closeMenu(); switchView('landing'); scrollToEl('framework')">Framework</button>
    <button class="mobile-menu-link" onclick="closeMenu(); switchView('strategy')">Brand Sim</button>
    <a href="https://pennio-design.github.io/portfolio.pdf" target="_blank" class="mobile-menu-link" onclick="closeMenu()">Portfolio</a>
    <a href="#apply" class="mobile-menu-cta" onclick="closeMenu(); switchView('landing')">Free Diagnosis</a>
  </div>

  <!-- ═══════════════════ LANDING VIEW ═══════════════════════════════════ -->
  <div id="landingView">

    <!-- ─── HERO ───────────────────────────────────────────────────────── -->
    <section id="hero">
      <div class="hero-left">
        <div class="hero-eyebrow">Meaning-First Brand Architecture</div>
        <h1 class="hero-h1">
          Your brand<br>isn't the problem.<br>
          <em>Your positioning is.</em>
        </h1>
        <p class="hero-sub">
          We build brand architecture for vision-driven founders — the strategic layer that determines whether your company is remembered or ignored. Design comes last.
        </p>
        <div class="hero-actions">
          <button class="btn-primary" onclick="switchView('strategy')">Run Brand Sim →</button>
          <a href="#apply" class="btn-secondary">Get Free Diagnosis</a>
        </div>
      </div>

      <!-- ─── BRAND SIGNAL SCANNER ──────────── -->
      <div class="hero-right">
        <div class="scanner-card" id="scannerCard">
          <div class="scanner-header">
            <div class="scanner-dots">
              <div class="scanner-dot r"></div>
              <div class="scanner-dot y"></div>
              <div class="scanner-dot g"></div>
            </div>
            <div class="scanner-title">Brand Architecture Scan · Live Audit</div>
          </div>
          <div class="scanner-body">
            <div class="scanner-label">Scanning brand signals</div>
            <div class="signal-row" id="sig1">
              <div class="signal-name">
                <div class="signal-icon fail">✕</div>
                Positioning Clarity
              </div>
              <span class="signal-status fail">Unclear</span>
            </div>
            <div class="signal-row" id="sig2">
              <div class="signal-name">
                <div class="signal-icon fail">✕</div>
                Messaging Architecture
              </div>
              <span class="signal-status fail">Generic</span>
            </div>
            <div class="signal-row" id="sig3">
              <div class="signal-name">
                <div class="signal-icon warn">!</div>
                Visual Identity System
              </div>
              <span class="signal-status warn">Inconsistent</span>
            </div>
            <div class="signal-row" id="sig4">
              <div class="signal-name">
                <div class="signal-icon fail">✕</div>
                Authority Signals
              </div>
              <span class="signal-status fail">Missing</span>
            </div>
            <div class="signal-row" id="sig5">
              <div class="signal-name">
                <div class="signal-icon warn">!</div>
                Conversion Flow Logic
              </div>
              <span class="signal-status warn">Weak</span>
            </div>
            <div class="scanner-footer" id="scannerFooter">
              <div class="scanner-verdict">5 critical gaps detected</div>
              <div class="scanner-count">₦ losing</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ─── PROBLEM SECTION ────────────────────────────────────────────── -->
    <section id="problem">
      <div class="section-max">
        <div class="reveal">
          <div class="section-label">The Distinction</div>
          <h2 class="section-h2">Decorators vs. <em>Architects</em></h2>
          <p class="section-body">Most design work fixes the surface. Brand architecture fixes the structure beneath it. Here's what separates the two.</p>
        </div>
        <div class="problem-grid reveal reveal-d1">
          <div class="problem-col bad">
            <div class="problem-col-label">What decorators do</div>
            <ul class="problem-items">
              <li class="problem-item">Build a logo before defining what the brand means</li>
              <li class="problem-item">Choose colors before establishing a market position</li>
              <li class="problem-item">Write copy that describes features, not transformation</li>
              <li class="problem-item">Deliver files — not systems, not strategy, not direction</li>
              <li class="problem-item">Optimize for aesthetics that the founder likes, not outcomes that clients buy</li>
            </ul>
          </div>
          <div class="problem-col good">
            <div class="problem-col-label">What architects build</div>
            <ul class="problem-items">
              <li class="problem-item">Positioning thesis established before any visual decision</li>
              <li class="problem-item">Messaging framework that makes value undeniable in one sentence</li>
              <li class="problem-item">Visual system that carries cultural weight and compounds over time</li>
              <li class="problem-item">Brand architecture that scales from pitch deck to market category</li>
              <li class="problem-item">Proof layer that replaces claims with case-backed conviction</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- ─── FRAMEWORK ──────────────────────────────────────────────────── -->
    <section id="framework">
      <div class="section-max">
        <div class="framework-intro">
          <div class="reveal">
            <div class="section-label">The 3-Pillar Framework</div>
            <h2 class="section-h2">Methodology for brands that<br><em>earn their price.</em></h2>
          </div>
          <div class="reveal reveal-d1">
            <p class="section-body">
              Clarity eliminates the guesswork. Credibility eliminates the doubt. Conviction eliminates the negotiation. Together they close the gap between what your brand is worth and what the market believes it's worth.
            </p>
          </div>
        </div>

        <div class="pillars reveal">
          <div class="pillar">
            <div class="pillar-num">01</div>
            <div class="pillar-name">Clarity</div>
            <div class="pillar-body">
              If your ideal client can't articulate your value in one sentence without coaching, the positioning isn't working. We rebuild the message from the core thesis outward — not from the tagline inward.
            </div>
            <div class="pillar-truth">"Define what you mean before you design how you look."</div>
          </div>
          <div class="pillar">
            <div class="pillar-num">02</div>
            <div class="pillar-name">Credibility</div>
            <div class="pillar-body">
              Authority is not claimed — it's demonstrated. We replace generic expertise signals with precision proof: case-backed results, documented thinking, and a brand system that shows you've done this before.
            </div>
            <div class="pillar-truth">"Replace assertions with architecture."</div>
          </div>
          <div class="pillar">
            <div class="pillar-num">03</div>
            <div class="pillar-name">Conviction</div>
            <div class="pillar-body">
              We don't sell services. We sell inevitable outcomes. When a prospect understands the cost of their current positioning problem, the price conversation changes. Conviction replaces persuasion.
            </div>
            <div class="pillar-truth">"When the diagnosis is undeniable, the solution sells itself."</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ─── PERCEPTION GAP ─────────────────────────────────────────────── -->
    <section id="perception">
      <div class="section-max">
        <div class="perception-grid">
          <div class="reveal">
            <div class="section-label">The Gap</div>
            <h2 class="section-h2">Your value is a 10.<br>Your market presence<br>reads as <em>a 3.</em></h2>
            <p class="section-body" style="margin-bottom: 32px;">
              This is the most expensive problem most founders don't know they have. The gap between your actual expertise and your perceived authority is where deals die, price sensitivity lives, and ideal clients walk to someone more visible.
            </p>
            <p class="section-body">We close that gap — systematically, not stylistically.</p>
            <div class="stats-row" style="margin-top: 40px;">
              <div class="stat">
                <div class="stat-num">₦5M+</div>
                <div class="stat-label">Min. project value</div>
              </div>
              <div class="stat">
                <div class="stat-num">2</div>
                <div class="stat-label">Clients per month</div>
              </div>
              <div class="stat">
                <div class="stat-num">100%</div>
                <div class="stat-label">Strategy-first</div>
              </div>
            </div>
          </div>

          <div class="reveal reveal-d2">
            <div class="gap-visual" id="gapVisual">
              <div class="gap-visual-label">The Perception Benchmark</div>
              <div class="gap-bars">
                <div class="gap-bar-wrap">
                  <div class="gap-bar-val" id="barVal1">0/10</div>
                  <div class="gap-bar actual" id="barActual"></div>
                  <div class="gap-bar-name">Actual Value</div>
                </div>
                <div class="gap-bar-wrap">
                  <div class="gap-bar-val" id="barVal2">0/10</div>
                  <div class="gap-bar perceived" id="barPerceived"></div>
                  <div class="gap-bar-name">Market Perception</div>
                </div>
              </div>
              <div class="gap-divider"></div>
              <div class="gap-note">
                The gap is not a design problem.<br>
                It's a <strong>positioning architecture</strong> problem.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ─── APPLY SECTION ──────────────────────────────────────────────── -->
    <section id="apply">
      <div class="apply-bg">
        <div class="apply-bg-grid"></div>
      </div>
      <div class="apply-inner">
        <div class="reveal">
          <div class="section-label" style="justify-content: center;">Free Diagnosis</div>
          <h2 class="apply-h2">
            45 minutes.<br>
            <em>Real gaps. Real fixes.</em>
          </h2>
          <p class="apply-sub">A live screen-share where we show exactly what's costing you deals — whether you hire us or not.</p>
          <p class="apply-disclaimer">No pitch. No pressure. Just a prioritised action plan.</p>
        </div>

        <div class="apply-form-card reveal reveal-d1">
          <div class="strategy-attached" id="strategyIndicator" style="display:none;">
            <div class="strategy-attached-icon">◎</div>
            <div>
              <div class="strategy-attached-label">Brand Sim Result Attached</div>
              <div class="strategy-attached-val" id="strategyText"></div>
            </div>
          </div>

          <form id="applyForm">
            <input type="hidden" name="_subject" value="New Audit Request (PENNIO)">
            <input type="hidden" name="strategy_result" id="hiddenStrategy" value="None">

            <div class="form-grid">
              <div>
                <label class="form-label">Name</label>
                <input required name="name" class="form-input" placeholder="Your name">
              </div>
              <div>
                <label class="form-label">Email</label>
                <input required name="email" type="email" class="form-input" placeholder="your@email.com">
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Current Website (if any)</label>
              <input name="website" class="form-input" placeholder="www.yourbrand.com">
            </div>

            <div class="form-group">
              <label class="form-label">Biggest brand challenge right now</label>
              <div style="position:relative;">
                <select name="challenge" class="form-select" required>
                  <option value="" disabled selected>Select the most urgent issue</option>
                  <option>My messaging doesn't communicate my actual value</option>
                  <option>I attract the wrong clients who can't afford me</option>
                  <option>I'm not known in my market despite being good at what I do</option>
                  <option>My brand looks like everyone else's</option>
                  <option>I'm competing on price instead of positioning</option>
                  <option>I'm launching something new and want to build it right</option>
                </select>
              </div>
            </div>

            <button id="submitBtn" type="submit" class="submit-btn">
              Send Website for Diagnosis
            </button>
          </form>

          <div id="successMessage" style="display:none;" class="success-state">
            <div class="success-icon">✓</div>
            <h3 class="success-h3">Request Received</h3>
            <p class="success-p">Reviewed personally. Expect a calendar link in your inbox within 24 hours.</p>
            <button class="success-back" onclick="location.reload()">Back to top</button>
          </div>
        </div>
      </div>
    </section>

  </div><!-- /landingView -->

  <!-- ═══════════════════ STRATEGY SIM VIEW ══════════════════════════════ -->
  <div id="strategyView" class="view-hidden">
    <div class="sim-wrap">
      <div class="sim-header">
        <div class="sim-title">Brand Position Simulator</div>
        <div class="sim-step-track" id="stepTrack"></div>
      </div>

      <div id="gameUI">
        <div class="sim-layout">
          <div class="prob-card">
            <div class="prob-label">Closing Probability</div>
            <div class="prob-num" id="gameProbDisplay">15%</div>
            <div class="prob-bar-bg">
              <div class="prob-bar-fill" id="gameProbBar"></div>
            </div>
            <div class="prob-feedback" id="probFeedback">Make your first positioning decision</div>
          </div>

          <div class="sim-main">
            <div class="sim-badge" id="simPillarBadge">Pillar Challenge</div>
            <div class="sim-scenario" id="gameScenario">Loading scenario</div>
            <div class="sim-options" id="gameOptions"></div>
          </div>
        </div>
      </div>

      <div id="gameResult" class="view-hidden">
        <div class="sim-result">
          <div class="result-graphic">
            <svg width="96" height="96" viewBox="0 0 96 96">
              <circle class="result-ring" cx="48" cy="48" r="42"/>
              <circle class="result-ring-fill" id="resultRing" cx="48" cy="48" r="42"/>
            </svg>
            <div class="result-icon-text" id="resultIconText">%</div>
          </div>

          <div class="result-complete">Simulation Complete</div>
          <div class="result-prob-line" id="finalProb">Closing Probability: 15%</div>
          <div class="result-rank" id="finalRank">Background Noise</div>
          <p class="result-verdict" id="finalVerdict">Your positioning isn't differentiated enough to command premium prices. Founders in your market are losing deals not because of price — but because of unclear value architecture.</p>

          <button class="result-cta" onclick="attachStrategyToForm()">
            Attach to Audit & Book Fix →
          </button>
          <button class="result-restart" onclick="resetGame()">Restart Simulation</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ─── FOOTER ─────────────────────────────────────────────────────── -->
  <footer>
    <div class="footer-logo">PENNIO<span>.</span>DESIGN</div>
    <div class="footer-links">
      <button class="nav-link" onclick="switchView('landing')">Framework</button>
      <button class="nav-link" onclick="switchView('strategy')">Brand Sim</button>
      <a href="https://pennio-design.github.io/portfolio.pdf" target="_blank" class="nav-link">Portfolio</a>
    </div>
    <div class="footer-copy">© 2026 PENNIO Agency</div>
  </footer>

  <!-- ─── VITE REACT ENTRY POINT ──────────────────────────────────────── -->
  <script type="module" src="/index.tsx"></script>

  <!-- ─── VANILLA JS LOGIC ────────────────────────────────────────────── -->
  <script>
    function toggleMenu() {
      document.getElementById('hamburger').classList.toggle('open');
      document.getElementById('mobileMenu').classList.toggle('open');
    }
    
    function closeMenu() {
      const btn = document.getElementById('hamburger');
      const menu = document.getElementById('mobileMenu');
      if (btn) btn.classList.remove('open');
      if (menu) menu.classList.remove('open');
    }
    
    document.addEventListener('click', function(e) {
      const menu = document.getElementById('mobileMenu');
      const btn  = document.getElementById('hamburger');
      if (menu && menu.classList.contains('open') && !menu.contains(e.target) && !btn.contains(e.target)) {
        closeMenu();
      }
    });

    function switchView(v) {
      closeMenu();
      document.getElementById('landingView').classList.toggle('view-hidden', v !== 'landing');
      document.getElementById('strategyView').classList.toggle('view-hidden', v !== 'strategy');
      window.scrollTo({ top: 0, behavior: 'smooth' });
      if (v === 'strategy') resetGame();
    }

    function scrollToEl(id) {
      setTimeout(() => {
        const el = document.getElementById(id);
        if (el) el.scrollIntoView({ behavior: 'smooth' });
      }, 80);
    }

    window.addEventListener('scroll', () => {
      const doc = document.documentElement;
      const pct = (doc.scrollTop / (doc.scrollHeight - doc.clientHeight)) * 100;
      document.getElementById('scrollLine').style.width = pct + '%';
    });

    function animateScanner() {
      const rows = [1,2,3,4,5];
      rows.forEach((n, i) => {
        setTimeout(() => {
          const el = document.getElementById('sig' + n);
          if (el) el.classList.add('lit');
        }, 300 + i * 320);
      });
      setTimeout(() => {
        const footer = document.getElementById('scannerFooter');
        if (footer) footer.classList.add('lit');
      }, 300 + 5 * 320 + 200);
    }
    setTimeout(animateScanner, 600);

    function animateGapBars() {
      const actual    = document.getElementById('barActual');
      const perceived = document.getElementById('barPerceived');
      const v1 = document.getElementById('barVal1');
      const v2 = document.getElementById('barVal2');
      if (!actual) return;

      setTimeout(() => {
        actual.style.height    = '100%';
        perceived.style.height = '32%';
        let n1 = 0, n2 = 0;
        const t1 = setInterval(() => { n1 = Math.min(n1+1, 10); if(v1) v1.textContent = n1 + '/10'; if(n1===10) clearInterval(t1); }, 60);
        const t2 = setInterval(() => { n2 = Math.min(n2+1, 3);  if(v2) v2.textContent = n2 + '/10'; if(n2===3)  clearInterval(t2); }, 200);
      }, 200);
    }

    const gapVisual = document.getElementById('gapVisual');
    if (gapVisual) {
      const barObserver = new IntersectionObserver((entries) => {
        entries.forEach(e => { if (e.isIntersecting) { animateGapBars(); barObserver.unobserve(e.target); } });
      }, { threshold: 0.4 });
      barObserver.observe(gapVisual);
    }

    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) { e.target.classList.add('visible'); revealObserver.unobserve(e.target); }
      });
    }, { threshold: 0.12, rootMargin: '0px 0px -40px 0px' });
    document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));

    const SCENARIOS = [
      {
        pillar: "Pillar 01 · Clarity",
        scenario: "A founder visits your site for the first time. They have 5 seconds. Your hero headline says",
        options: [
          { label: "We deliver innovative, client-focused design solutions for modern businesses.", impact: -18, feedback: "Generic positioning. 'Innovative' and 'client-focused' signal nothing — every competitor says the same thing. The prospect bounced." },
          { label: "We build brand architecture for African founders who are done competing on price.", impact: 28, feedback: "Targeted, specific, and polarising. It immediately disqualifies the wrong client and attracts the right one. The prospect scrolls." }
        ]
      },
      {
        pillar: "Pillar 02 · Credibility",
        scenario: "A warm prospect asks: 'Why should I trust you over someone charging half your rate?'",
        options: [
          { label: "We have years of experience and we really care about the results we get for clients.", impact: -14, feedback: "Claims without proof. 'We care' is the lowest-conviction thing a service provider can say. Every competitor says this too." },
          { label: "Here's the exact positioning framework we used to help [Founder X] move from ₦200k to ₦2M projects.", impact: 32, feedback: "Specific, documented, case-backed. You replaced a claim with a proof. The price comparison disappears — they're now comparing outcomes, not rates." }
        ]
      },
      {
        pillar: "Pillar 01 · Clarity",
        scenario: "You're writing your about page. You have 3 paragraphs. What do you lead with?",
        options: [
          { label: "Your founder story — 10 years of design, client list, what inspires you every morning.", impact: -10, feedback: "Story without outcome doesn't convert. Prospects don't buy your biography — they buy the transformation it produced." },
          { label: "The positioning problem you solve, who you solve it for, and what changes after you do.", impact: 25, feedback: "Outcome-first architecture. The prospect reads this and immediately thinks 'this is for me' — or knows it's not. Both outcomes are correct." }
        ]
      },
      {
        pillar: "Pillar 03 · Conviction",
        scenario: "The perfect prospect says: 'I love your work — but your price is beyond our current budget.'",
        options: [
          { label: "We could do a lighter version of the project for something closer to your range.", impact: -22, feedback: "Discounting before the value is established destroys your positioning. You've signalled that the price was negotiable — and your credibility with it." },
          { label: "I understand. Let me show you what this positioning problem is currently costing you per quarter.", impact: 38, feedback: "You reframed price as ROI. If they can see the cost of staying where they are, the investment looks different. Conviction replaces persuasion." }
        ]
      },
      {
        pillar: "Pillar 02 · Credibility",
        scenario: "You're posting content. You have one post slot. What do you publish?",
        options: [
          { label: "A motivational post about consistency, resilience, and doing the work even when no one is watching.", impact: -8, feedback: "Inspiration without expertise. It gets likes from peers — not from founders who need your service. This is the most common content trap." },
          { label: "A breakdown of why a well-known brand's positioning is failing — with the specific strategic fix.", impact: 30, feedback: "Expertise demonstrated publicly. This is the post a founder screenshots and sends to their co-founder. It proves you think at architecture level, not decoration level." }
        ]
      }
    ];

    let currentStep = 0;
    let probability = 15;

    const VERDICTS = {
      authority: { rank: "Market Authority", verdict: "Your positioning decisions are operating at Brand Architect level. You're building conviction, not just messaging — and that's the difference between asking for the rate and earning it." },
      contender: { rank: "Solid Contender", verdict: "Strong strategic instincts, with a few critical gaps still costing you deals. The right positioning moves here could shift your closing rate significantly." },
      generic: { rank: "Generic Player", verdict: "Your brand is indistinguishable from competitors in your market. That's not a design problem — it's a positioning architecture problem. The fix is structural, not cosmetic." },
      noise: { rank: "Background Noise", verdict: "Your positioning isn't differentiated enough to command premium prices. Founders in your market lose deals not because of price — but because of unclear value architecture. This is fixable." }
    };

    function getVerdict(p) {
      if (p >= 85) return VERDICTS.authority;
      if (p >= 60) return VERDICTS.contender;
      if (p >= 35) return VERDICTS.generic;
      return VERDICTS.noise;
    }

    function buildStepTrack() {
      const track = document.getElementById('stepTrack');
      if (!track) return;
      track.innerHTML = '';
      SCENARIOS.forEach((_, i) => {
        const dot = document.createElement('div');
        dot.className = 'sim-step-dot' + (i < currentStep ? ' done' : i === currentStep ? ' active' : '');
        track.appendChild(dot);
      });
    }

    function animateProbTo(target) {
      const bar = document.getElementById('gameProbBar');
      const display = document.getElementById('gameProbDisplay');
      if (bar) bar.style.width = target + '%';
      if (display) display.textContent = target + '%';
    }

    function renderGame() {
      if (currentStep >= SCENARIOS.length) { showResult(); return; }
      buildStepTrack();
      const data = SCENARIOS[currentStep];
      
      const badge = document.getElementById('simPillarBadge');
      const scenario = document.getElementById('gameScenario');
      const feedback = document.getElementById('probFeedback');
      const opts = document.getElementById('gameOptions');

      if (badge) badge.textContent = data.pillar;
      if (scenario) scenario.textContent = data.scenario;
      if (feedback) feedback.textContent = 'Make your positioning decision';
      animateProbTo(probability);

      if (!opts) return;
      opts.innerHTML = '';
      data.options.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = 'sim-option';
        btn.innerHTML = `<span class="sim-option-text">${opt.label}</span><span class="sim-option-arrow">→</span>`;
        btn.onclick = () => {
          probability = Math.min(100, Math.max(0, probability + opt.impact));
          if (feedback) feedback.textContent = opt.feedback;
          opts.querySelectorAll('button').forEach(b => b.disabled = true);
          setTimeout(() => { currentStep++; renderGame(); }, 1200);
        };
        opts.appendChild(btn);
      });
    }

    function showResult() {
      document.getElementById('gameUI').classList.add('view-hidden');
      document.getElementById('gameResult').classList.remove('view-hidden');

      const v = getVerdict(probability);
      const finalProb = document.getElementById('finalProb');
      const finalRank = document.getElementById('finalRank');
      const finalVerdict = document.getElementById('finalVerdict');
      const iconText = document.getElementById('resultIconText');
      const ring = document.getElementById('resultRing');

      if (finalProb) finalProb.textContent = `Closing Probability: ${probability}%`;
      if (finalRank) finalRank.textContent = v.rank;
      if (finalVerdict) finalVerdict.textContent = v.verdict;
      if (iconText) iconText.textContent = probability + '%';

      if (ring) {
        const offset = 264 - (probability / 100) * 264;
        setTimeout(() => { ring.style.strokeDashoffset = offset; }, 100);
      }
      buildStepTrack();
    }

    function resetGame() {
      currentStep = 0;
      probability = 15;
      const gameUI = document.getElementById('gameUI');
      const gameResult = document.getElementById('gameResult');
      const ring = document.getElementById('resultRing');

      if (gameUI) gameUI.classList.remove('view-hidden');
      if (gameResult) gameResult.classList.add('view-hidden');
      if (ring) ring.style.strokeDashoffset = 264;
      renderGame();
    }

    function attachStrategyToForm() {
      const v = getVerdict(probability);
      const indicator = document.getElementById('strategyIndicator');
      const text = document.getElementById('strategyText');
      const hidden = document.getElementById('hiddenStrategy');

      if (indicator) indicator.style.display = 'flex';
      if (text) text.textContent = `${v.rank} · ${probability}% closing probability`;
      if (hidden) hidden.value = `${v.rank} (Score: ${probability}%)`;
      
      switchView('landing');
      setTimeout(() => { 
        const applySec = document.getElementById('apply');
        if(applySec) applySec.scrollIntoView({ behavior: 'smooth' }); 
      }, 120);
    }

    const form    = document.getElementById('applyForm');
    const success = document.getElementById('successMessage');
    const btn     = document.getElementById('submitBtn');

    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (btn) {
          btn.disabled = true;
          btn.innerHTML = '<span style="display:inline-block;width:16px;height:16px;border:2px solid rgba(0,0,0,0.3);border-top-color:#000;border-radius:50%;animation:spin 0.7s linear infinite;margin-right:10px;"></span> Sending';
        }

        const formData = new FormData(form);
        fetch("https://formsubmit.co/ajax/ea0da421e8e6e82457be40792262eeed", {
          method: "POST",
          headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
          body: JSON.stringify(Object.fromEntries(formData))
        })
        .then(r => r.json())
        .then(() => {
          form.style.display = 'none';
          const indicator = document.getElementById('strategyIndicator');
          if (indicator) indicator.style.display = 'none';
          if (success) success.style.display = 'block';
          form.reset();
        })
        .catch(() => {
          alert('Error submitting. Please email hello@pennio.design directly.');
          if (btn) {
            btn.disabled = false;
            btn.innerHTML = 'Send Website for Diagnosis';
          }
        });
      });
    }

    renderGame();

    const style = document.createElement('style');
    style.textContent = '@keyframes spin { to { transform: rotate(360deg); } }';
    document.head.appendChild(style);
  </script>
</body>
</html>